<!doctype html>
<html>
  <head>
    <title>Publish Camera Swap Test</title>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <meta content="width=device-width, initial-scale=1, user-scalable=no" name="viewport">
    <script src="../../lib/webrtc/adapter.js"></script>
    <script src="../../lib/videojs/video.min.js"></script>
    <script src="../../lib/videojs/videojs-media-sources.min.js"></script>
    <script src="../../lib/videojs/videojs.hls.min.js"></script>
    <script src="../../script/testbed-config.js"></script>
    <script src="../../script/red5pro-utils.js"></script>
    <link rel="stylesheet" href="../../lib/videojs/video-js.min.css">
    <link rel="stylesheet" href="../../css/reset.css">
    <link rel="stylesheet" href="../../css/testbed.css">
  </head>
  <body>
    <div id="app">
      <p class="version-field">Testbed Version: 2.0.4&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://infrared5.github.io/red5pro-html-sdk-testbed/red5pro-html-testbed-latest.zip">download</a></p>
      <div id="back-link-container" style="text-align: left;"><p id="back-link"><a href="../../index.html">&lt; Settings</a></p></div>
      <h1 class="centered">Publish Camera Swap Test</h1>
      <hr />
      <h2 class="centered"><em>stream</em>: <span id="stream-title"></span></h2>
      <p id="support-field" class="hint-alert"><em>The browser you are using </em><strong>does not support</strong><em> the </em><code>facingMode</code><em> video constraint require for this test.</em></p>
      <p id="status-field" class="centered status-field">On hold.</p>
      <script>
        (function (window, document) {
          'use strict';
      
          var field = document.getElementById('status-field');
      
          function updateStatusFromEvent (event) {
            var pubTypes = window.red5prosdk.PublisherEventTypes;
            var rtcTypes = window.red5prosdk.RTCPublisherEventTypes;
            var status;
            switch (event.type) {
              case pubTypes.CONNECT_SUCCESS:
                status = 'Connection established...';
                break;
              case pubTypes.CONNECT_FAILURE:
                status = 'Error - Could not establish connection.';
                break;
              case pubTypes.PUBLISH_START:
                status = 'Started publishing session.';
                break;
              case pubTypes.PUBLISH_FAIL:
                status = 'Error - Could not start a publishing session.';
                break;
              case pubTypes.PUBLISH_INVALID_NAME:
                status = 'Error - Stream name already in use.';
                break;
              case rtcTypes.MEDIA_STREAM_AVAILABLE:
                status = 'Stream available...';
                break;
              case rtcTypes.PEER_CONNECTION_AVAILABLE:
                status = 'Peer Connection available...';
                break;
              case rtcTypes.OFFER_START:
                status = 'Begin offer...';
                break;
              case rtcTypes.OFFER_END:
                status = 'Offer accepted...';
                break;
              case rtcTypes.ICE_TRICKLE_COMPLETE:
                status = 'Negotiation complete. Waiting Publish Start...';
                break;
            }
            field.innerText = ['STATUS', status].join(': ');
          }
      
          window.red5proHandlePublisherEvent = updateStatusFromEvent;
      
        })(this, document);
      </script>
      <p id="statistics-field" class="centered status-field"></p>
      <div id="video-container" class="centered">
        <div class="centered">
          <video id="red5pro-publisher-video" controls class="video-element" muted></video>
        </div>
      </div>
    </div>
    <script src="../../lib/es6/es6-promise.min.js"></script>
    <script src="../../lib/es6/es6-bind.js"></script>
    <script src="../../lib/es6/es6-array.js"></script>
    <script src="../../lib/es6/es6-object-assign.js"></script>
    <script src="../../lib/es6/es6-fetch.js"></script>
    <script src="../../lib/red5pro/red5pro-sdk.min.js"></script>
    <script src="index.js"></script>
  </body>
</html>
